<!-- src/app/navbar/navbar.component.html -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand d-flex align-items-center" (click)="goListing()" role="button">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-car-front me-2" viewBox="0 0 16 16">
        <path d="M4 9a1 1 0 1 1-2 0 1 1 0 0 1 2 0m10 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0M6 8a1 1 0 0 0 0 2h4a1 1 0 1 0 0-2zM4.862 4.276 3.906 6.19a.51.51 0 0 0 .497.731c.91-.073 2.35-.17 3.597-.17s2.688.097 3.597.17a.51.51 0 0 0 .497-.731l-.956-1.913A.5.5 0 0 0 10.691 4H5.309a.5.5 0 0 0-.447.276"></path>
        <path d="M2.52 3.515A2.5 2.5 0 0 1 4.82 2h6.362c1 0 1.904.596 2.298 1.515l.792 1.848c.075.175.21.319.38.404.5.25.855.715.965 1.262l.335 1.679q.05.242.049.49v.413c0 .814-.39 1.543-1 1.997V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.338c-1.292.048-2.745.088-4 .088s-2.708-.04-4-.088V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.892c-.61-.454-1-1.183-1-1.997v-.413a2.5 2.5 0 0 1 .049-.49l.335-1.68c.11-.546.465-1.012.964-1.261a.8.8 0 0 0 .381-.404l.792-1.848ZM4.82 3a1.5 1.5 0 0 0-1.379.91l-.792 1.847a1.8 1.8 0 0 1-.853.904.8.8 0 0 0-.43.564L1.03 8.904a1.5 1.5 0 0 0-.03.294v.413c0 .796.62 1.448 1.408 1.484 1.555.07 3.786.155 5.592.155s4.037-.084 5.592-.155A1.48 1.48 0 0 0 15 9.611v-.413q0-.148-.03-.294l-.335-1.68a.8.8 0 0 0-.43-.563 1.8 1.8 0 0 1-.853-.904l-.792-1.848A1.5 1.5 0 0 0 11.18 3z"></path>
      </svg>
      <span class="d-none d-sm-inline">Car Showcase</span>
    </a>

    <!-- Mobile menu button -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto">
        <li class="nav-item">
          <a class="nav-link" (click)="goListing()" role="button">
            <i class="bi bi-list-ul me-1"></i>Listing
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" (click)="goManage()" role="button">
            <i class="bi bi-gear me-1"></i>Manage
          </a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Payment Modal -->
@if(showPaymentModal) {
<div class="modal fade show" tabindex="-1" style="display:block; background: rgba(0,0,0,.5);">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Add Payment Details</h5>
        <button type="button" class="btn-close" aria-label="Close" (click)="closePaymentModal()"></button>
      </div>

      <form (ngSubmit)="addPayment(paymentFormRef)" #paymentFormRef="ngForm">
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Card Holder Name <span class="text-danger">*</span></label>
            <input
              class="form-control"
              name="cardHolder"
              [(ngModel)]="paymentData.cardHolder"
              required
              maxlength="100"
              placeholder="Enter card holder name" />
            @if(submitted && !paymentData.cardHolder) {
            <div class="text-danger small mt-1">
              Card holder name is required.
            </div>
            }
          </div>

          <div class="mb-3">
            <label class="form-label">Card Number <span class="text-danger">*</span></label>
            <input
              class="form-control"
              name="cardNumber"
              [(ngModel)]="paymentData.cardNumber"
              required
              maxlength="16"
              placeholder="1234567890123456"
              pattern="[0-9]{16}" />
            @if(submitted && !paymentData.cardNumber) {
            <div class="text-danger small mt-1">
              Card number is required.
            </div>
            }
            @if(submitted && paymentData.cardNumber && !isValidCardNumber()) {
            <div class="text-danger small mt-1">
              Card number must be exactly 16 digits.
            </div>
            }
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label class="form-label">Expiration Date <span class="text-danger">*</span></label>
                <input
                  class="form-control"
                  name="expDate"
                  [(ngModel)]="paymentData.expDate"
                  required
                  maxlength="5"
                  placeholder="MM/YY"
                  pattern="(0[1-9]|1[0-2])\/([0-9]{2})" />
                @if(submitted && !paymentData.expDate) {
                <div class="text-danger small mt-1">
                  Expiration date is required.
                </div>
                }
                @if(submitted && paymentData.expDate && !isValidExpDate()) {
                <div class="text-danger small mt-1">
                  Please enter date in MM/YY format.
                </div>
                }
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label class="form-label">CVV <span class="text-danger">*</span></label>
                <input
                  class="form-control"
                  name="cvv"
                  [(ngModel)]="paymentData.cvv"
                  required
                  maxlength="3"
                  placeholder="123"
                  pattern="[0-9]{3}" />
                @if(submitted && !paymentData.cvv) {
                <div class="text-danger small mt-1">
                  CVV is required.
                </div>
                }
                @if(submitted && paymentData.cvv && !isValidCvv()) {
                <div class="text-danger small mt-1">
                  CVV must be exactly 3 digits.
                </div>
                }
              </div>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" (click)="closePaymentModal()">Cancel</button>
          <button type="submit" class="btn btn-primary">Add Payment</button>
        </div>
      </form>
    </div>
  </div>
</div>
}
